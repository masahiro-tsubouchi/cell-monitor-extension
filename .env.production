# =======================================================
# JupyterLab Cell Monitor Extension - 本番環境設定
# =======================================================
# 本番環境専用の設定ファイル
# 使用方法: ./scripts/setup-env.sh production

# =======================================================
# 🌍 環境設定 (CENTRAL CONFIGURATION)
# =======================================================
NODE_ENV=production

# ベースホスト設定（本番環境）
# 以下を実際のサーバーIPアドレスに変更してください
SERVER_HOST=YOUR_SERVER_IP
SERVER_IP=${SERVER_HOST}

# プロトコル設定（本番環境ではHTTPS推奨）
USE_HTTPS=false
HTTP_PROTOCOL=${USE_HTTPS:+https:}${USE_HTTPS:-http:}
WS_PROTOCOL=${USE_HTTPS:+wss:}${USE_HTTPS:-ws:}

# ポート設定
INSTRUCTOR_DASHBOARD_PORT=3000
JUPYTERLAB_PORT=8888
FASTAPI_PORT=8000
POSTGRES_PORT=5432
INFLUXDB_PORT=8086
REDIS_PORT=6379

# Docker UID/GID
HOST_UID=1000
HOST_GID=1000

# =======================================================
# 🌐 外部アクセス用URL（ブラウザからのアクセス）
# =======================================================
# フロントエンド設定 (instructor-dashboard)
REACT_APP_API_BASE_URL=${HTTP_PROTOCOL}//${SERVER_IP}:${FASTAPI_PORT}/api/v1
REACT_APP_WS_URL=${WS_PROTOCOL}//${SERVER_IP}:${FASTAPI_PORT}
REACT_APP_DEBUG=false

# JupyterLab Extension用（本番環境では実際のIPを設定）
CELL_MONITOR_SERVER_URL=${HTTP_PROTOCOL}//${SERVER_IP}:${FASTAPI_PORT}/api/v1/events
JUPYTERLAB_URL=${HTTP_PROTOCOL}//${SERVER_IP}:${JUPYTERLAB_PORT}
FASTAPI_URL=${HTTP_PROTOCOL}//${SERVER_IP}:${FASTAPI_PORT}/api/v1/events

# =======================================================
# 🐳 Docker内部通信用設定（コンテナ間通信）
# =======================================================
# 本番環境でも基本的にはコンテナ名を使用（同一Docker環境の場合）
POSTGRES_SERVER=postgres
REDIS_HOST=redis
INFLUXDB_SERVER=http://influxdb

# =======================================================
# 🚀 FastAPIサーバー設定
# =======================================================
PROJECT_NAME=Student Progress Tracker API (Production)
PROJECT_VERSION=1.0.0
API_V1_STR=/api/v1

# CORS設定（本番環境では制限的に設定）
BACKEND_CORS_ORIGINS=${HTTP_PROTOCOL}//${SERVER_IP}:${JUPYTERLAB_PORT},${HTTP_PROTOCOL}//${SERVER_IP}:${INSTRUCTOR_DASHBOARD_PORT}

# ログレベル
LOG_LEVEL=INFO
DEBUG=false

# =======================================================
# 🗄️ データベース設定
# =======================================================
POSTGRES_USER=admin
POSTGRES_PASSWORD=CHANGE_THIS_SECURE_PASSWORD_IN_PRODUCTION
POSTGRES_DB=progress_db

INFLUXDB_INIT_USERNAME=admin
INFLUXDB_INIT_PASSWORD=CHANGE_THIS_SECURE_PASSWORD_IN_PRODUCTION
INFLUXDB_INIT_ORG=your-production-org
INFLUXDB_INIT_BUCKET=progress_bucket
INFLUXDB_INIT_ADMIN_TOKEN=CHANGE_THIS_SECURE_TOKEN_IN_PRODUCTION

# =======================================================
# 🔐 セキュリティ設定 (本番環境)
# =======================================================
# 本番環境では必ず強力なキーを生成してください
# SECRET_KEY=$(openssl rand -hex 64)
SECRET_KEY=CHANGE_THIS_TO_SECURE_RANDOM_KEY_IN_PRODUCTION
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# JupyterLab認証（本番環境では強力なトークンを設定）
# JUPYTER_TOKEN=$(openssl rand -hex 16)
JUPYTER_TOKEN=CHANGE_THIS_TO_SECURE_TOKEN_IN_PRODUCTION

# =======================================================
# 🧪 JupyterLab拡張機能設定
# =======================================================
CELL_MONITOR_DEFAULT_EMAIL=student@your-school.edu
CELL_MONITOR_DEFAULT_TEAM=チーム1
CELL_MONITOR_DEFAULT_USER=学生
CELL_MONITOR_TEST_MODE=false

# CSP設定
CSP_FASTAPI_HOSTS=${SERVER_IP}:${FASTAPI_PORT}

# =======================================================
# 🔧 Docker Build設定
# =======================================================
PYTHON_VERSION=3.12-slim
NODE_VERSION=18-alpine
NODE_MAJOR_VERSION=20
JUPYTERLAB_VERSION=4.0
POSTGRES_VERSION=16-alpine
REDIS_VERSION=7-alpine
INFLUXDB_VERSION=2.7

# =======================================================
# 🔍 監視・ログ設定
# =======================================================
LOG_FORMAT=json
LOG_ROTATION=daily
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3

# =======================================================
# 🌟 SSL/TLS設定 (本番環境のみ)
# =======================================================
# 本番環境でSSLを使用する場合は以下を有効にしてください
# USE_HTTPS=true
# SSL_CERT_PATH=/etc/ssl/certs/cert.pem
# SSL_KEY_PATH=/etc/ssl/private/key.pem